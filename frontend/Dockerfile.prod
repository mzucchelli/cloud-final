FROM node:18

ARG VITE_AWS_REGION
ENV VITE_AWS_REGION=${VITE_AWS_REGION}

ARG VITE_AWS_COGNITO_USERPOOLID
ENV VITE_AWS_COGNITO_USERPOOLID=${VITE_AWS_COGNITO_USERPOOLID}

ARG VITE_AWS_COGNITO_CLIENTID
ENV VITE_AWS_COGNITO_CLIENTID=${VITE_AWS_COGNITO_CLIENTID}

ARG VITE_API_URL
ENV VITE_API_URL=${VITE_API_URL}

WORKDIR /app

COPY package*.json ./

RUN npm ci

COPY . .

RUN npm run build

RUN npm install serve -g

EXPOSE 5173

CMD [ "serve", "-s", "-p", "5173", "dist" ]
